import pandas as pdfrom pathlib import Pathfrom exofop.download import System, SystemDownloaderfrom exofop.extract import LightCurveTableListfrom exofop.utils.logger import configure_root_loggerconfigure_root_logger()csv_file = "ASTR502_Master_Target_List.csv"df = pd.read_csv(csv_file)base_data_dir = Path("data/Exofop")  outputs_dir   = Path("/Users/carmencardenas/Documents/GitHub/Astro502_sp26/exofop_outputs")outputs_dir.mkdir(parents=True, exist_ok=True)failed = []def infer_system_string(row) -> str:    # ExoFOP-friendly: usually the star/system name (hostname)    if "hostname" in row and pd.notna(row["hostname"]):        return str(row["hostname"]).strip()    # fallback: planet name    if "pl_name" in row and pd.notna(row["pl_name"]):        return str(row["pl_name"]).strip()    raise ValueError("No hostname/pl_name found for this row.")for i, row in df.iterrows():    try:        system_str = infer_system_string(row)        print(f"\n=== [{i}] {system_str} ===")        system = System(system_str)        loader = SystemDownloader(system=system, data_dir=str(base_data_dir))            tags = loader.time_series.tags        if len(tags) == 0:            print("No time-series tags found.")            continue              loader.download(tags[:5], unzip=True)        target_dir = loader.target_dir        # Extract into LightCurveTableList        lctl = LightCurveTableList.load_exofop_data(target_dir=target_dir)        # Standardize and time-correct        lctl.standardise_column_names()        lctl.apply_time_correction_in_case_of_discrepancy()        # Save per target        safe_name = system_str.replace(" ", "_")        out_dir = outputs_dir / safe_name        out_dir.mkdir(parents=True, exist_ok=True)        lctl.save(out_dir)          lctl.info_df.to_csv(out_dir / "info_df.csv", index=False)        print(f"Saved: {out_dir}")        if len(lctl.incomplete) > 0:            print("WARNING: some light curves incomplete standardization:", lctl.incomplete)    except Exception as e:        failed.append((i, str(e)))        print(f"FAILED [{i}] {e}")print("\nDone.")if failed:    print("\nFailed targets:")    for i, msg in failed[:20]:        print(i, msg)